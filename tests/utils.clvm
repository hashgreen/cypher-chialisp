(
  (defmacro @tests.assert-fails (statement)
    ;; Expect the statement to fail.

    (qq (if
      (= (f (mod () (unquote statement))) (q . x))
      1
      (x (q . (unquote statement)) "should fail!")
    ))
  )

  (defmacro @tests.assert-equal (statement result)
    ;; Expect the statement to evaluate to result.

    (qq (if
      (= (unquote statement) (unquote result))
      1
      (x (q . (unquote statement)) "does not evaluate to" (q . (unquote result)))
    ))
  )

  (defmacro @tests.assert args
    ;; Assert a series of statements.
    ;
    ; Usage: (assert cond1 cond2 ...)

    (if (r args)
      (qq (if (unquote (f args))
        (unquote (c @tests.assert (r args)))
        (x (q . (unquote (f args))) "evalutes to false.")
      ))
      (f args)
    )
  )
)
